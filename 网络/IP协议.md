## IP协议

- IP地址属于网络层地址

- IP地址

  - 构成：网络地址+主机地址，共32位
  - 分类：A类（0xxxxx，前8位是网络标识）、B类（10xxxxx，前16位是网络标识）、C类（110xxxxxx，前24位是网络标识）、D类（1110xxxxxx，32位都是网络标识，没有主机标识，用于多播）
  - 广播地址：主机地址全为1，分为本地广播和直接广播
  - IP多播：多播使用D类地址
  - IP属于面向无连接的原因：1）简化。2）提速

- 子网掩码：避免分类造成地址浪费

- 路由控制

  - 路由控制是指将分组数据发送到最终目标地址的功能。
  - 路由控制表：记录了IP数据在下一步应该发给哪个路由器，ip包将根据这个路由表在各个数据链路上传输
  - 路由分类
    1. 默认路由：0.0.0.0 /0
    2. 主机路由：32位全部参与，一部都是网络地址参与路由。 IP地址 /32
    3. 环路路由

- IP分割处理（分片）和再构造处理

  - 因为每种数据链路的最大传输单元（MTU）不同，所以当IP报文过大，会进行分片处理，而重组只能由目标主机进行。

  - 路径MTU的过程：

    发送端主机将首部的分片禁止标识位置为1（禁止分片），然后发送，途中遇到需要分片的路由器，不进行分片而是丢弃包，随后通过一个ICMP的不可达消息将数据链路上的MTU发送给主机，此后发送端的主机，将MTU的值设为接收到的MTU值，进行分片处理，如此反复知道再也没有收到ICMP消息为止，就能确定最小的MTU值。然后对MTU进行缓存（10min），方便以后使用。

    - UDP：如上述过程。注意：分片是在IP层，UDP没有重发处理，并且目标主机需要重组
    - TCP：如上述过程。注意：分片是在TCP层。TCP有重发处理，IP层无需再分片，目标主机无需重组

- ### DNS协议

  - DNS：域名解析协议

  - 构成：树形结构

  - 域名服务器：管理域名的主机或者软件、管理所在分层的域的相关信息

    每层域名服务器都有着它下一层域名服务器的相关信息。

  - 解析器：进行DNS查询的主机和软件。用户的电脑就是一个解析器

    DNS查询：会先从自己所在的域名服务器查询，如是没有目标IP地址，则从根域名服务器向下遍历查找，直到找到为止，最后由找到的域名服务器返回想要的数据。解析器和域名服务器会将信息保存在自己的缓存里，方便下次查找。

- ### ARP协议

  - ARP：解决地址问题，以目标的IP地址为线索，来定位下一个接受数据分包的网络设备对应的MAC地址（适用于IPV4）
  - 工作机制：主机A为了获得主机B的MAC地址，首先会通过广播发送一个ARP请求包（主机B的IP地址），在同一条数据链路上的主机或者路由器收到这个ARP请求包，如果请求包里IP地址与自己的IP地址一致，就将自己的MAC地址塞入ARP响应包里，返回给主机A。
  - IP地址和MAC地址缺一不可吗？对

- ### RARP协议

  - 是将ARP协议反过来

- ### ICMP协议（辅助IP）

  - 主要功能：确认IP包是否成功送达目标地址，通知再发送过程中IP包被废弃的原因，改善网络设置等。

- ### DHCP协议

  - DHCP：实现自动设置IP地址、统一管理IP地址分配
  - 架设一台DHCP服务器、然后将要分配的IP地址设置到服务器上、还要有相应的子网掩码、路由控制信息、DNS服务器的地址

  

